<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>SmartCity — Login & Recharge</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
body{background:#000;color:white;font-family:'Inter',sans-serif;overflow-x:hidden;}
canvas#particles{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;}
.glass{background:rgba(255,255,255,0.08);border:1px solid rgba(255,255,255,0.15);backdrop-filter:blur(8px);}
input{background:rgba(255,255,255,0.1);border:none;padding:0.75rem 1rem;width:100%;color:white;border-radius:8px;}
button{background:linear-gradient(to right,#facc15,#fbbf24);color:black;padding:0.75rem 1.5rem;border-radius:8px;font-weight:600;}
button:hover{transform:scale(1.03);}
.fade{opacity:0;transform:translateY(20px);transition:all .7s ease;}
.fade.show{opacity:1;transform:translateY(0);}
</style>
</head>
<body>
<canvas id="particles"></canvas>

<div class="min-h-screen flex flex-col items-center justify-center space-y-10 px-4">
  <form id="loginForm" class="glass p-8 rounded-2xl w-full max-w-md space-y-6 text-center">
    <h1 class="text-2xl font-bold text-yellow-400">SmartCity Login</h1>
    <input id="email" type="email" placeholder="Email" required>
    <input id="password" type="password" placeholder="Password" required>
    <div id="error" class="text-red-500 text-sm min-h-[1.2em]"></div>
    <button type="submit" class="w-full">Sign In</button>
    <button type="button" onclick="fillDemo()" class="mt-3 text-sm underline text-yellow-400">Auto-fill Demo</button>
  </form>

  <section id="rechargeSection" class="glass p-8 rounded-2xl w-full max-w-2xl hidden fade text-center">
    <h2 class="text-xl font-semibold text-yellow-400 mb-4">Welcome, <span id="userName"></span>!</h2>
    <p class="text-slate-300 mb-2">Customer ID: <span id="ccc"></span></p>
    <form id="rechargeForm" class="flex flex-col sm:flex-row gap-3 justify-center mt-4">
      <input id="amount" type="number" min="1" placeholder="Enter Recharge Amount ₹" required class="text-black px-4 py-2 rounded-lg">
      <button type="submit">Recharge</button>
    </form>
    <div id="msg" class="mt-3 text-sm"></div>
    <div class="mt-6 text-left">
      <h3 class="text-lg font-semibold text-yellow-400 mb-3">Previous Transactions</h3>
      <div id="transactions" class="space-y-3 text-sm"></div>
    </div>
  </section>
</div>

<script>
const USERS=[
  {email:'user@example.com',password:'pass123',customerId:'CCC-1001',name:'Asha Patel'},
  {email:'raj@smartcity.com',password:'raj2025',customerId:'CCC-2077',name:'Raj Kumar'}
];
const login=document.getElementById('loginForm');
const section=document.getElementById('rechargeSection');
login.addEventListener('submit',e=>{
  e.preventDefault();
  const em=email.value.trim().toLowerCase(),pw=password.value;
  const found=USERS.find(u=>u.email===em&&u.password===pw);
  if(!found){error.textContent='Invalid credentials.';return;}
  localStorage.setItem('sc_user',JSON.stringify(found));
  login.classList.add('hidden');
  section.classList.remove('hidden');
  setTimeout(()=>section.classList.add('show'),100);
  loadUser(found);
});
function fillDemo(){email.value='user@example.com';password.value='pass123';}
function loadUser(u){
  userName.textContent=u.name;
  ccc.textContent=u.customerId;
  const key='tx_'+u.customerId;
  let tx=JSON.parse(localStorage.getItem(key)||'[]');
  const render=()=>{transactions.innerHTML=tx.length?tx.slice().reverse().map(t=>`
    <div class='p-3 bg-black/40 border border-yellow-500/20 rounded-lg flex justify-between'>
      <span>₹${t.amount}</span><span>${new Date(t.date).toLocaleString()}</span>
    </div>`).join(''):'<p class="text-slate-400">No transactions yet.</p>';};
  render();
  rechargeForm.onsubmit=e=>{
    e.preventDefault();
    const val=+amount.value;if(!val)return;
    const entry={amount:val,date:new Date().toISOString()};
    tx.push(entry);localStorage.setItem(key,JSON.stringify(tx));render();
    msg.textContent=`Recharged ₹${val} successfully!`;msg.style.color='lightgreen';
    setTimeout(()=>msg.textContent='',3000);
    amount.value='';
  }
}
const c=document.getElementById('particles'),ctx=c.getContext('2d');let w,h,p=[];
function resize(){w=innerWidth;h=innerHeight;c.width=w;c.height=h;}
window.addEventListener('resize',resize);resize();
for(let i=0;i<150;i++)p.push({x:Math.random()*w,y:Math.random()*h,r:Math.random()*2+0.5,dx:(Math.random()-0.5)*0.3,dy:(Math.random()-0.5)*0.3});
function draw(){
  ctx.clearRect(0,0,w,h);
  for(let a of p){ctx.beginPath();ctx.arc(a.x,a.y,a.r,0,2*Math.PI);
    ctx.fillStyle='rgba(255,215,0,0.9)';ctx.fill();a.x+=a.dx;a.y+=a.dy;
    if(a.x<0||a.x>w)a.dx*=-1;if(a.y<0||a.y>h)a.dy*=-1;}
  requestAnimationFrame(draw);
}
draw();
</script>
</body>
</html>
